var prevlat,prevLng;$(document).ready((function(){initMap()}));var input=document.getElementById("pac-input"),markers=[],map,infoWindow,marker;function initMap(zoom=10){var position={lat:prevlat,lng:prevLng};if(console.log(position),map=new google.maps.Map(document.getElementById("map"),{center:{lat:prevlat,lng:prevLng},zoom:zoom}),marker&&marker.setMap(null),marker=new google.maps.Marker({position:position,map:map}),markers.push(marker),infoWindow=new google.maps.InfoWindow,$("input[name='first_latlng']").val()&&""!=$("input[name='first_latlng']").val()){var marker=new google.maps.Marker({position:new google.maps.LatLng(parseInt($("input[name='first_lat']").val()),parseInt($("input[name='first_lng']").val())),map:map});markers.push(marker)}$(".get-first-location").on("click",(function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(position){var pos={lat:position.coords.latitude,lng:position.coords.longitude};infoWindow.setPosition(pos),infoWindow.setContent("Location found."),infoWindow.open(map),map.setCenter(pos)}),(function(){handleLocationError(!0,infoWindow,map.getCenter())})):handleLocationError(!1,infoWindow,map.getCenter())})),markers.push(marker),markers2.push(marker);var geocoder=new google.maps.Geocoder;function addMarker(location){deleteMarkers();var marker=new google.maps.Marker({position:location,map:map});markers.push(marker)}function setMapOnAll(map){for(var i=0;i<markers.length;i++)markers[i].setMap(map);for(var i=0;i<markers2.length;i++)markers[i].setMap(map)}function clearMarkers(){setMapOnAll(null)}function deleteMarkers(){clearMarkers(),markers=[],markers2=[]}google.maps.event.addListener(map,"click",(function(event){var latitude=event.latLng.lat(),longitude=event.latLng.lng();$("input[name='first_lat']").val(latitude),$("input[name='first_lng']").val(longitude),$("input[name='first_latlng']").val(event.latLng),splitLatLng(String(event.latLng)),geocoder.geocode({latLng:event.latLng},(function(results,status){status==google.maps.GeocoderStatus.OK&&results[0]&&(deleteMarkers(),addMarker(event.latLng),$("input[name='FirstAddressLocation']").attr("value",results[0].formatted_address),$("#pac-input").val(results[0].formatted_address))}))}));var autocomplete=new google.maps.places.Autocomplete(input);autocomplete.bindTo("bounds",map),autocomplete.addListener("place_changed",(function(){var place=autocomplete.getPlace();if(place.geometry){place.geometry.viewport?map.fitBounds(place.geometry.viewport):(map.setCenter(place.geometry.location),map.setZoom(17)),addMarker(place.geometry.location);var address="";place.address_components&&(address=[place.address_components[0]&&place.address_components[0].short_name||"",place.address_components[1]&&place.address_components[1].short_name||"",place.address_components[2]&&place.address_components[2].short_name||""].join(" ")),infowindowContent.children["place-icon"].src=place.icon,infowindowContent.children["place-name"].textContent=place.name,infowindowContent.children["place-address"].textContent=address,infowindow.open(map,marker)}else window.alert("No details available for input: '"+place.name+"'")}))}function handleLocationError(browserHasGeolocation,infoWindow,pos){infoWindow.setPosition(pos),infoWindow.setContent(browserHasGeolocation?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),infoWindow.open(map)}function splitLatLng(latLng){var newString,newString2,trainindIdArray=latLng.substring(0,latLng.length-1).substring(1).split(","),lat=trainindIdArray[0],Lng=trainindIdArray[1];$("input[name='first_lat']").val(lat),$("input[name='first_lng']").val(Lng)}$("input[name='first_lat']").val()&&""!=$("input[name='first_lng']").val()&&null!=$("input[name='first_latlng']").val()?(prevlat=parseFloat($("input[name='first_lat']").val()),prevLng=parseFloat($("input[name='first_lng']").val())):(prevlat=29.3166497,prevLng=47.7273433);